import random
import os
import sys
import math

if (len(sys.argv) < 2 or (sys.argv[1] == "")):
    distance = 0.8
else:
    distance = float(sys.argv[1])

filename = os.path.basename(__file__)

radius = -1  # Modify this value to change the curvature of the wall
box_width = .025 * 1.5 # Modify this value to change the width of the boxes
angle_step = 180 / 40  # Modify this value to change the density of the boxes along the curve

angle_slope = 4.5 # (180 - 0) / (40 - 0)

xml_elements = ""
for j in range(20):
    z = (j * -0.05) + 1
    for i in range(40):
        if (i + j) % 2 == 0:
            color = "1 1 1"  # white
        else:
            color = "0 0 0"  # black
        angle = math.radians(i * angle_step)
        x = (radius * math.cos(angle) - radius) + radius
        y = (radius * math.sin(angle)) + distance - radius
        euler_z = (angle_slope * i)  # Rotate the boxes around the z-axis
        xml_elements += f'<geom type="box" size=".025 {box_width} .025" pos="{x} {y} {z}" euler="0 0 {euler_z}" rgba="{color} 1" />\n'

xml_file = f'''
<!-- This file was generated by build_curved_wall.py -->
<!-- It is not recommended to edit this file -->
<mujoco>
    <default>
        <geom density="100" friction=".5" rgba="1 .6 .8 1" />
    </default>
    <worldbody>
        {xml_elements}
    </worldbody>
</mujoco>
'''

# Save the XML file
with open('model/walls/curved_wall.xml', 'w') as f:
    f.write(xml_file)

print(f'Complete. ({filename}))')
